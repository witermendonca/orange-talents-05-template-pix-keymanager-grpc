version: '3'
services:
    bcb:
        image: "public.ecr.aws/d8b2x5c9/orange-stack-sat-bcb-pix"
        ports: 
            - 8082:8082
    itau:
        image: "public.ecr.aws/d8b2x5c9/orange-stack-sat-itau-erp"
        ports: 
            - 9091:9091
    postgres:
        image: 'postgres:alpine'
        ports:
            - 5432:5432
        environment:
            POSTGRES_USER: keymanager
            POSTGRES_PASSWORD: keymanager
            POSTGRES_DB: db_keymanager
            POSTGRES_HOST: postgres

    api-key-manager-grpc:
        build:
            dockerfile: ./Dockerfile
            context: .
        container_name: api-key-manager-grpc
        ports:
            - 50051:50051
        depends_on:
            - postgres
            - bcb
            - itau
        environment:
            ITAU_URL: "http://itau:9091"
            BCB_URL: "http://bcb:8082"
            JDBC_URL: jdbc:postgresql://postgres/db_keymanager